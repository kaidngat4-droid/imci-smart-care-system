<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <title>Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… | IMCI</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/all.min.css">
    <style>
        body {
            margin: 0;
            font-family: 'Cairo', sans-serif;
            background: #f3f4f6;
            color: #111;
        }
        header.topbar {
            background: #065f46;
            color: #fff;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 30px;
            box-shadow: 0 4px 8px rgba(0,0,0,0.1);
        }
        header.topbar h2 { margin:0; font-size:20px; }
        header.topbar div span { font-weight:bold; margin-right:15px; }
        header.topbar button {
            background: #ef4444; border:none; color:#fff;
            padding:8px 16px; border-radius:6px; cursor:pointer; font-weight:bold;
        }
        header.topbar button:hover { background: #b91c1c; }

        .layout { display:flex; min-height: calc(100vh - 60px); }
        .sidebar {
            width: 220px; background: #047857; display:flex; flex-direction: column;
            padding: 20px;
        }
        .sidebar button {
            background: #065f46; color:#fff; border:none; padding:12px; margin-bottom:15px;
            border-radius:8px; font-weight:bold; cursor:pointer; text-align:right; font-size:14px;
            transition:0.3s;
        }
        .sidebar button:hover { background: #10b981; }

        .dashboard-container { flex:1; padding:30px; }
        .welcome-box {
            background: #ecfdf5; padding:25px; border-radius:14px;
            margin-bottom:25px; box-shadow:0 4px 12px rgba(0,0,0,0.05);
        }
        .welcome-box h2 { font-size:22px; color:#065f46; font-weight:bold; margin-bottom:10px; }
        .welcome-box p strong { font-weight:bold; color:#065f46; }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
        }
        .stat-card {
            background: #fff; padding:25px 15px; border-radius:14px;
            box-shadow:0 4px 12px rgba(0,0,0,0.05);
            display:flex; flex-direction:column; align-items:center; justify-content:center;
            transition: transform 0.2s; position: relative;
        }
        .stat-card:hover { transform: translateY(-5px); }
        .stat-card h3 { font-size:28px; font-weight:700; color:#047857; margin:10px 0 5px 0; }
        .stat-card p { font-size:14px; font-weight:bold; color:#374151; text-align:center; }
        .stat-card i { font-size:32px; color:#10b981; margin-bottom:10px; }
    </style>
</head>
<body>

<header class="topbar">
    <h2>Ø¨Ø±Ù†Ø§Ù…Ø¬ IMCI Ø§Ù„Ø±Ù‚Ù…ÙŠ</h2>
    <div>
        <span id="facilityName"></span>
        <button onclick="logout()">Ø®Ø±ÙˆØ¬</button>
    </div>
</header>

<div class="layout">
    <aside class="sidebar">

        <button onclick="goTo('child-form.html')">
            <i class="fa-solid fa-child"></i> ğŸ§’ ØªØ³Ø¬ÙŠÙ„ Ø·ÙÙ„
        </button>

        <button onclick="goTo('monthly-report.html')">
            <i class="fa-solid fa-chart-column"></i> ğŸ“Š Ø§Ù„ØªÙ‚Ø±ÙŠØ± Ø§Ù„Ø´Ù‡Ø±ÙŠ
        </button>

        <button onclick="alert('Ø³ÙŠØªÙ… ØªØ·ÙˆÙŠØ± Ø§Ù„Ø¯Ù„ÙŠÙ„ Ù„Ø§Ø­Ù‚Ù‹Ø§')">
            <i class="fa-solid fa-book"></i> ğŸ“˜ Ø§Ù„Ø¯Ù„ÙŠÙ„ Ø§Ù„Ø¥Ø±Ø´Ø§Ø¯ÙŠ
        </button>

        <!-- ğŸ”½ Ø£Ø¶Ù Ù‡Ø°Ø§ Ø§Ù„Ø²Ø± Ø§Ù„Ø¬Ø¯ÙŠØ¯ Ù‡Ù†Ø§ -->
        <button onclick="goTo('drug-stock.html')">
            <i class="fa-solid fa-pills"></i> ğŸ’Š Ø­Ø±ÙƒØ© Ø§Ù„Ù…Ø®Ø²ÙˆÙ† Ø§Ù„Ø¯ÙˆØ§Ø¦ÙŠ
        </button>

    </aside>

    <div class="dashboard-container">

        <div class="welcome-box">
            <h2>Ù…Ø±Ø­Ø¨Ø§Ù‹ Ø¨ÙƒÙ… ÙÙŠ Ù„ÙˆØ­Ø© Ø§Ù„ØªØ­ÙƒÙ… Ù„Ù†Ø¸Ø§Ù…IMCIØ§Ù„Ø°ÙƒÙŠ Ù…ÙƒØªØ¨ Ø§Ù„ØµØ­Ø©ÙˆØ§Ù„Ø¨ÙŠØ¦Ø©Ù…Ø­Ø§ÙØ¸Ø©Ø¥Ø¨</h2>
            <p>
                Ù…Ø±ÙƒØ²: <strong id="facilityNameDisplay"></strong><br>
                Ø§Ù„Ø³Ù†Ø©: <strong id="currentYear"></strong>
            </p>
        </div>

        <div class="stats-grid">
            <div class="stat-card">
                <i class="fa-solid fa-users"></i>
                <h3 id="totalChildren">0</h3>
                <p>Ø¹Ø¯Ø¯ Ø§Ù„Ø£Ø·ÙØ§Ù„ Ø§Ù„Ù…Ø³Ø¬Ù„ÙŠÙ†</p>
            </div>

            <div class="stat-card">
                <i class="fa-solid fa-lungs"></i>
                <h3 id="pneumoniaCases">0</h3>
                <p>Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø§Ù„ØªÙ‡Ø§Ø¨ Ø§Ù„Ø±Ø¦ÙˆÙŠ</p>
            </div>

            <div class="stat-card">
                <i class="fa-solid fa-droplet"></i>
                <h3 id="diarrheaCases">0</h3>
                <p>Ø­Ø§Ù„Ø§Øª Ø§Ù„Ø¥Ø³Ù‡Ø§Ù„</p>
            </div>

            <div class="stat-card">
                <i class="fa-solid fa-ambulance"></i>
                <h3 id="referralCases">0</h3>
                <p>Ø¹Ø¯Ø¯ Ø§Ù„Ø¥Ø­Ø§Ù„Ø§Øª</p>
            </div>
        </div>

    </div>
</div>

<script>
    // ===== Ø­Ù…Ø§ÙŠØ© Ø§Ù„ØµÙØ­Ø© =====
    if (localStorage.getItem("imci_logged_in") !== "true") {
        window.location.href = "login.html";
    }

    const facility = localStorage.getItem("imci_facility") || "Ù…Ø±ÙƒØ² ØºÙŠØ± Ù…Ø¹Ø±ÙˆÙ";
    document.getElementById("facilityName").textContent = facility;
    document.getElementById("facilityNameDisplay").textContent = facility;
    document.getElementById("currentYear").textContent = new Date().getFullYear();

    function goTo(page) { window.location.href = page; }
    function logout() {
        localStorage.setItem("imci_logged_in","false");
        window.location.href="login.html";
    }

    // ===== ØªØ­Ù…ÙŠÙ„ Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª Ø§Ù„Ø¯ÙŠÙ†Ø§Ù…ÙŠÙƒÙŠØ© =====
    const children = JSON.parse(localStorage.getItem("imci_children")) || [];

    // ØªØµÙÙŠØ© Ø§Ù„Ø£Ø·ÙØ§Ù„ Ø­Ø³Ø¨ Ø§Ù„Ù…Ø±ÙƒØ² Ø§Ù„Ø­Ø§Ù„ÙŠ
    const filteredChildren = children.filter(c => c.facility === facility);

    // Ø­Ø³Ø§Ø¨ Ø§Ù„Ø¥Ø­ØµØ§Ø¦ÙŠØ§Øª
    const totalChildren = filteredChildren.length;
    const pneumoniaCases = filteredChildren.filter(c => c.classifications?.cough?.includes("Ø§Ù„ØªÙ‡Ø§Ø¨ Ø±Ø¦ÙˆÙŠ")).length;
    const diarrheaCases = filteredChildren.filter(c => c.classifications?.diarrhea?.includes("Ø¥Ø³Ù‡Ø§Ù„")).length;
    const referralCases = filteredChildren.filter(c => c.treatment?.referral).length;

    // Ø¹Ø±Ø¶ Ø§Ù„Ù‚ÙŠÙ…
    document.getElementById("totalChildren").textContent = totalChildren;
    document.getElementById("pneumoniaCases").textContent = pneumoniaCases;
    document.getElementById("diarrheaCases").textContent = diarrheaCases;
    document.getElementById("referralCases").textContent = referralCases;
</script>
</body>
</html>
